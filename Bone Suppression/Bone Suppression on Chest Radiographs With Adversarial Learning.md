# Bone Suppression on Chest Radiographs With Adversarial Learning | Pix2Pix, CycleGAN

**핵심 주장 및 주요 기여**  
본 논문은 **일반적인 단일 에너지 흉부 방사 영상(CXR)**을 입력으로 받아, **골 구조(갈비뼈·쇄골)를 억제한 소프트 조직 영상**을 생성하는 프레임워크를 제안한다. GAN 기반의 두 가지 학습 전략(환자별로 쌍을 이루는 Pix2Pix, 쌍이 없는 Cycle-GAN)을 비교하여,  
1. 환자별 페어링이 가능한 경우엔 Pix2Pix가 SSIM·PSNR에서 약간 우수한 성능을 보이고,  
2. 페어링 불가능하거나 **AP 투영**과 같은 분포 차이가 있는 영상에선 Cycle-GAN의 일반화 능력이 더 뛰어남을 보였다.  

이로써 특수장비 없이도 저선량 단일 에너지 흉부 X선에서 임상적 가치가 높은 뼈 억제 영상을 생성할 수 있음을 입증했다.

## 1. 문제 정의  
- **기존 DE(dual-energy) 영상**: 뼈와 연부조직을 에너지 레벨별로 분리하나,  
  - 고비용 특수장비 필요  
  - 선량 증가  
  - 환자 움직임으로 인한 아티팩트 발생  
- **목표**: 일반 CXR만으로 DE와 유사한 뼈 억제 영상을 얻어, 진단 정확도를 개선하면서 비용·선량 부담 완화.

## 2. 제안 방법

### 2.1 Pix2Pix 기반 페어드 학습  
- **입력** $$X_s$$: 일반 CXR, **목표** $$X_t$$: DE 억제 CXR  
- **생성기** $$G$$와 **판별기** $$D$$  
- **손실 함수**  

$$
    \min_G \max_D \; \mathbb{E}\_{X_s,X_t}\big[\log D(X_s,X_t)\big]
    \;+\;\mathbb{E}_{X_s}\big[\log\big(1 - D(X_s,G(X_s))\big)\big]
    \;+\;\lambda\,\|X_t - G(X_s)\|_1
  $$  

- $$\lambda$$: L1 재건 손실 가중치  
- **특징**: 1:1 정렬된 페어 데이터가 필요.

### 2.2 Cycle-GAN 기반 언페어드 학습  
- **두 도메인** $$S$$ (일반 CXR), $$T$$ (DE 억제 CXR)  
- **두 생성기** $$G_{S\to T}, G_{T\to S}$$  
- **두 판별기** $$D_S, D_T$$  
- **손실 함수**  
  1. **적대 손실**: $$\mathcal{L}\_{GAN}(G_{S\to T},D_T,S,T)$$  
  2. **사이클 일관성**:  

$$\mathcal{L}\_{cyc} = \mathbb{E}\_{x\sim S}\|G_{T\to S}(G_{S\to T}(x)) - x\|\_1 + \mathbb{E}\_{y\sim T}\|G_{S\to T}(G_{T\to S}(y)) - y\|_1$$  

- **특징**: 도메인별 비정렬 영상만으로 학습 가능 → 다양한 분포에 대한 **일반화** 우수.

## 3. 모델 구조  
- **입력·출력 해상도**: 모두 $$512\times512$$  
- **Pix2Pix**: U-Net 기반 생성기, PatchGAN 판별기  
- **Cycle-GAN**: ResNet 블록 기반 생성기, PatchGAN 판별기  
- **평가 지표**  
  - DE 테스트셋: **SSIM**, **PSNR**  
  - 표준 CXR(NIH)셋: **질병 분류 AUC** (VGG-19 이용)

## 4. 실험 결과 및 성능 향상

| 학습 방식   | DE 테스트 (SSIM)       | DE 테스트 (PSNR)      | 표준 CXR AUC           |
|----------|------------------------|-----------------------|------------------------|
| Pix2Pix (페어드) | **0.867 ± 0.011**        | **36.08 ± 0.31 dB**       | 0.948 ± 0.004          |
| Cycle-GAN (언페어드) | 0.855 ± 0.010          | 34.82 ± 0.29 dB        | **0.953 ± 0.003**       |

- **DE 영상 품질**: Pix2Pix 우세  
- **미지 분포(AP 포함)**: Cycle-GAN 우세 → **일반화 능력** 개선  
- **한계**:  
  - DE 데이터에 포함된 모션 아티팩트가 소수 → 모델이 모션 제거 특성 학습  
  - SSIM·PSNR은 DE 유사 분포에서만 측정 가능

## 5. 일반화 성능 향상 가능성  
- **언페어드 학습** 목적 자체가 **도메인 간 분포 차이** 허용  
- AP 투영, 기종별 장비 차이, 환자 포지셔닝 변이 등 현실적 변동에 강인  
- **추가 제안**:  
  - 다양한 병원·장비 소스의 언페어드 영상 도메인 포함  
  - 도메인 정규화 / 인variance 기법 도입  
  - 적대적 도메인 적응(ADA) 병합

## 6. 향후 연구 영향 및 고려 사항  
이 프레임워크는 **비침습적 뼈 억제** 외에도 **뼈 골절 분할**, **병변 검출**, **다중 조직 분리** 등으로 확장 가능하다.  
차후 연구 시  
- **대규모 멀티센터 데이터**로 일반화 검증  
- **임상 리더십**(진단 정확도·속도·용량) 종합 평가  
- **전산 효율성** 및 **실시간 적용** 고려  
- **해석 가능성** 및 **안정성 평가**(특이 케이스에서 오류 분석) 필요하다.  

**결론**  
GAN 기반 뼈 억제 기법은 단일 에너지 CXR만으로 DE와 유사한 소프트 조직 영상을 생성할 수 있으며, 특히 Cycle-GAN의 언페어드 학습이 다양한 실제 환경에서의 **일반화 성능**을 크게 개선할 가능성을 보여준다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/ee3059c7-9540-4c43-91ce-4aa71b6a305b/1131409.pdf
