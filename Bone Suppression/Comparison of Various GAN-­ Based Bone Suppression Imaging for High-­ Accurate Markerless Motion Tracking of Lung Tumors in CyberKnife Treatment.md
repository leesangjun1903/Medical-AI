# Comparison of Various GAN-­ Based Bone Suppression Imaging for High-­ Accurate Markerless Motion Tracking of Lung Tumors in CyberKnife Treatment

### 1. 핵심 주장 및 주요 기여

이 논문의 **핵심 주장**은 방사선 치료(SBRT) 중 호흡으로 인한 종양 움직임을 추적할 때 뼈 구조의 중첩으로 인한 종양 인식 저하 문제를 **생성 대립 네트워크(GAN) 기반 골 억제 기술**로 해결할 수 있다는 것입니다.[1]

**주요 기여**는 다음과 같습니다:

- **6가지 GAN 모델 비교 분석**: CycleGAN, DualGAN, CUT, FastCUT, DCLGAN, SimDCL 등 다양한 비지도 학습 기반 GAN 모델들의 성능을 체계적으로 비교하여 각 모델의 장단점을 밝혔습니다.[1]

- **예시적 데이터셋 활용**: XCAT 팬텀(4D Extended Cardiac-Torso Phantom)을 이용한 1120개의 제어된 시뮬레이션 이미지와 실제 환자 1000장의 비-시뮬레이션 이미지를 조합하여 모델의 일반화 능력을 검증했습니다.[1]

- **실상황 임상 적용 검증**: SimDCL이 최고의 이미지 생성 품질을 보여주었으며(FID: 68.93), CUT가 실제 환자 이미지에서 최고의 종양 추적 정확도(ZNCC: 0.789 ± 0.159)를 달성했습니다.[1]

---

### 2. 문제 정의, 제안 방법, 모델 구조 및 성능

#### 문제 정의

CyberKnife 시스템의 마커리스 추적 시스템(Xsight Lung Tracking System, XLTS)은 **뼈 구조(흉골, 갈비뼈, 척추 등)와 종양이 중첩될 때 종양 인식 실패 또는 저하**라는 근본적인 문제를 가지고 있습니다. 현재의 XLTS 알고리즘은 작거나 조밀한 해부학적 구조에 가려진 종양을 안정적으로 탐지하지 못합니다.[1]

#### 제안 방법 및 수식

논문에서 제안하는 **골 억제 이미지 생성 프로세스**는 다음과 같습니다:

**1) SSIM(구조유사성지수)**
구조적 유사성을 평가하는 핵심 메트릭으로, 각 블록 단위로 계산됩니다:

$$
\text{SSIM}(x, y) = \frac{(2\mu_x\mu_y + C_1)(2\sigma_{xy} + C_2)}{(\mu_x^2 + \mu_y^2 + C_1)(\sigma_x^2 + \sigma_y^2 + C_2)}
$$

여기서 $$\mu$$는 가우시안 필터링된 이미지의 평균, $$\sigma^2$$는 분산, $$C_1 = (0.01 \times 255)^2$$, $$C_2 = (0.03 \times 255)^2$$입니다.[1]

평균 SSIM은:

$$
\text{MSSIM} = \frac{1}{M}\sum_{j=1}^{M}\text{SSIM}(x_j, y_j)
$$

**2) PSNR(피크신호대잡음비)**

$$
\text{PSNR} = 10 \log_{10}\left(\frac{\text{PS}^2}{\text{MSE}}\right)
$$

여기서 MSE는:

$$
\text{MSE} = \frac{1}{N}\sum_{i=1}^{N}(x_i - y_i)^2
$$

**3) FID(Fréchet Inception Distance)**
생성 이미지의 리얼리즘을 평가합니다:

$$
\text{FID} = ||\mu_X - \mu_Y||^2 + \text{Tr}\left(\Sigma_X + \Sigma_Y - 2\sqrt{\Sigma_X\Sigma_Y}\right)
$$

여기서 $$\mu$$는 특성 벡터의 평균, $$\Sigma$$는 공분산 행렬, $$\text{Tr}$$은 대각합입니다.[1]

#### 모델 구조

| 모델 | 선택 기준 | 학습률 | 배치 크기 | 에포크 |
|------|---------|--------|---------|-------|
| CycleGAN | 비쌍 데이터를 위한 양방향 이미지 변환 | 0.0005 | 2 | 400 |
| DualGAN | 비쌍 데이터를 위한 이중 적대 네트워크 | 0.0001 | 4 | 400 |
| CUT | 비쌍 데이터를 위한 효율적 변환 | 0.0002 | 3 | 400 |
| FastCUT | 빠른 패치 레벨 변환 | 0.0002 | 5 | 400 |
| DCLGAN | 양방향 대조 학습 적용 | 0.0005 | 1 | 400 |
| SimDCL | 기본 대조 학습을 통한 간단하고 효율적인 변환 | 0.0006 | 1 | 400 |

**핵심 기술적 차이:**

- **CycleGAN**: Cycle-consistency 손실로 Geometric 왜곡 야기[1]
- **DCLGAN/SimDCL**: 대조 학습 통합으로 모드 붕괴(mode collapse) 해결[1]
- **SimDCL**: 유사성 손실 추가로 입력이 다르면 출력도 다르게 생성[1]

#### 성능 평가 결과

**XCAT 팬텀 기반 평가(표 2):**
- **SSIM**: SimDCL이 0.96 ± 0.02로 최고 (CycleGAN 0.90 ± 0.06)
- **PSNR**: SimDCL이 36.93 ± 3.93으로 최고 (DualGAN 30.94 ± 2.22)
- **FID**: SimDCL이 114.52 ± 32.60으로 최저 (DualGAN 193.45 ± 55.10)

**실제 환자 이미지 템플릿 매칭(표 3):**
- **ZNCC**: CUT가 0.789 ± 0.159로 최고 (FastCUT 0.785 ± 0.160)
- **정확도**: DCLGAN이 82.4% (824/1000), CUT가 80.4% (804/1000)
- **처리 속도**: SimDCL이 16.7 ms/image로 가장 빠름 (CycleGAN 66.0 ms/image)

**통계적 유의성**: Friedman 검정 결과 모든 지표에서 모델 간 유의미한 차이 확인 (p < 0.05)[1]

***

### 3. 일반화 성능 향상 가능성

#### 현재의 일반화 성능 특성

**강점:**
- XCAT 팬텀 데이터로 검증한 SimDCL의 높은 SSIM/PSNR은 구조적 정보 보존 능력을 시사합니다.[1]
- 50명의 다양한 환자 데이터(종양 크기 8-64mm, 나이 46-93세)를 사용하여 **이질적 임상 시나리오에서의 견고성**을 입증했습니다.[1]
- CUT의 높은 ZNCC값(0.789 ± 0.159)은 실제 환자 이미지에서의 **종양 위치 추적 정확도**를 보여줍니다.[1]

**한계와 일반화 문제:**

논문에서 명시된 주요 한계점들은:

1. **팬텀 데이터와 실제 데이터의 괴리**: 본 연구는 XCAT 팬텀(합성 데이터)으로 모델 학습 및 평가를 수행했으나, 실제 임상 데이터의 잡음과 변이를 완전히 반영하지 못합니다.[1]

2. **호흡 운동의 복잡성 미반영**: 실제 임상에서는 2-20mm의 호흡 운동이 발생하는데, 이것이 종양 추적 정확도에 큰 영향을 미치지만 충분히 다루어지지 않았습니다.[1]

3. **종양 다양성의 부분적 다루기**: 고-글래스 노듈(GGN)을 포함한 다양한 종양 타입에 대한 명확한 선택 기준 부재로, 모델의 특정 종양 타입에 대한 적응력 평가가 제한적입니다.[1]

4. **ZNCC와 이미지 품질 메트릭의 불일치**: 표 2와 표 3의 결과 괴리는 다음을 의미합니다:
   - SimDCL: 이미지 품질 최고 (FID 114.52) but ZNCC 상대적 낮음 (0.777 ± 0.161)
   - CUT: 이미지 품질 중간 but ZNCC 최고 (0.789 ± 0.159)[1]

   이는 **"높은 이미지 품질이 반드시 종양 탐지 정확도를 보장하지 않음"**을 의미하며, 일반화 성능 평가에 복잡성을 더합니다.[1]

#### 일반화 성능 향상 방안

**1) 데이터 확대 및 다양성 증대**
- 더 큰 규모의 이질적 임상 데이터셋(현재 50명 → 수백 명 이상)
- 다양한 호흡 패턴, 종양 크기/위치, 환자 체형 포함[1]

**2) 호흡 운동 모델링**
- 4D CT 데이터 활용으로 호흡 사이클 내 종양 움직임 명시적 학습[1]

**3) 하이브리드 손실 함수 설계**
- Sobel 손실과 지각적 손실(Perceptual Loss) 통합하여 종양 경계 선명도 향상[1]
- 논문에서 언급한 "SFRM-GAN"(Spatial Feature Resolution Maximization GAN) 방식 응용[1]

**4) Dice 유사도 계수(Dice Similarity Coefficient) 도입**
- SSIM/PSNR 외에 직접적 종양 탐지 성능을 측정할 메트릭 추가로 평가 정확성 개선[1]

**5) 적응적 하이퍼파라미터 조정**
- 호흡 운동 정도나 종양 특성에 따라 동적으로 Generator/Discriminator 균형 조정[1]

***

### 4. 향후 연구에 미치는 영향 및 고려사항

#### 영향

**의료 영상 처리 분야:**
- GAN 기반 골 억제 기술이 **CT/CBCT 금속 인공물 제거, 노이즈 감소** 등 다양한 응용으로 확대될 수 있는 기초 제공[1]
- 비지도 학습 방식이 의료 영상의 **쌍 데이터 부족 문제** 극복의 모범 사례 제시[1]

**방사선 치료 임상 적용:**
- 마커리스 추적 시스템(XLTS)의 신뢰성 향상으로 **골격 중첩 지역의 종양(종격동, 폐문부 인근)에 대한 치료 정확도 개선**[1]
- 실시간 종양 추적(16.7-94.7 ms/image 범위)으로 **치료 효율성 증대 가능성**[1]

**딥러닝 아키텍처 발전:**
- SimDCL의 **간단하면서도 효율적인 설계**가 의료용 경량 모델 개발의 방향 제시[1]

#### 향후 연구 시 고려사항

**1) 임상 검증 강화**
- 현재 연구가 50명 환자 데이터 기반이므로, **수천 명 규모의 다기관 다국가 임상 데이터** 수집 및 검증 필수[1]

**2) 호흡 운동의 명시적 모델링**
- **4D 영상 데이터** 활용으로 호흡 사이클 내 동적 종양 움직임 직접 학습[1]
- 호흡 신호 동기화를 통한 **실시간 추적 알고리즘** 개발

**3) 다중 메트릭 통합 평가**
- SSIM, PSNR, FID 외에 **의료 특화 메트릭** 추가:
  - Dice Similarity Coefficient (DSC)
  - 종양 경계 로컬라이제이션 정확도
  - 임상의 주관적 평가(비율 척도)[1]

**4) 모드 붕괴(Mode Collapse) 극복**
- 현재 SimDCL과 DCLGAN의 우수성에도 불구하고, **다양한 임상 시나리오에서의 견고성 지속적 모니터링**[1]

**5) 계산 효율성과 임상 적용성 균형**
- SimDCL의 빠른 처리 속도(16.7 ms/image)는 이상적이지만, **임베디드 의료 장비(CyberKnife, TrueBeam 등)에 대한 실제 통합 테스트** 필요[1]

**6) 노이즈 억제 기술 개선**
- 논문에서 "불충분한 노이즈 억제로 인한 종양 인식 실패"를 언급했으므로, **적응적 필터링 또는 다중 스케일 분석** 도입 검토[1]

**7) 비용-편익 분석**
- GAN 기반 골 억제 기술의 **임상 도입 비용, 치료 정확도 향상 정도, 환자 예후 개선 효과**에 대한 건강경제학적 평가[1]

***

### 결론

이 논문은 **다양한 GAN 아키텍처를 체계적으로 비교 분석**하여 CyberKnife 시스템의 마커리스 종양 추적 정확도를 향상시킬 수 있는 실용적 솔루션을 제시했습니다. SimDCL의 우수한 이미지 생성 품질과 CUT의 높은 임상 적용 정확도는 각각 다른 임상 목표를 달성할 수 있음을 보여줍니다. 그러나 호흡 운동, 다양한 종양 특성, 대규모 임상 데이터에 대한 추가 검증이 **진정한 임상 적용**을 위해 필수적입니다. 향후 연구는 이러한 한계를 극복하고, 실시간 치료 시나리오에서의 견고하고 신뢰할 수 있는 종양 추적 시스템 구축에 초점을 맞춰야 할 것입니다.[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/de7d0563-5498-4d17-9a2e-af08efaaee68/Thoracic-Cancer-2025-Mochizuki-Comparison-of-Various-GAN-Based-Bone-Suppression-Imaging-for-High-Accurate-Markerless.pdf)
