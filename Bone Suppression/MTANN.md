## MTANN(Massive-Training Artificial Neural Network) 

> 참고: [Deep Learning in Medical Imaging: Introducing MTANN (Meritis 블로그)](https://meritis.fr/blog/deep-learning-in-medical-imaging-introducing-mtann)

---

### 1. MTANN이란?

MTANN(Massive-Training Artificial Neural Network)은 의료 영상(예: CT, X-ray 등)에서 병변 검출, 분할, 조직 분류 등 다양한 작업에 사용되는 딥러닝 기반 인공신경망 모델입니다.  
특히, 의료 영상에서 작은 병변이나 미묘한 구조를 효과적으로 탐지하고 분류하는 데 강점을 보입니다.

---

### 2. 등장 배경

의료 영상 분석에서는 정확한 병변 검출과 분할이 매우 중요합니다. 기존의 딥러닝 모델(CNN 등)은 많은 데이터와 긴 학습 시간이 필요하며, 작은 병변이나 미묘한 구조를 놓칠 수 있습니다.  
MTANN은 이러한 문제를 해결하기 위해 고안되었습니다.

---

### 3. MTANN의 구조와 작동 원리

#### 3.1 구조

- **입력층:**  
  - 의료 영상의 작은 부분(패치)을 입력으로 받음  
  - 예시: 9x9 픽셀 크기의 이미지 패치

- **은닉층:**  
  - 시그모이드(sigmoid) 활성화 함수 사용  
  - 비선형 처리를 통해 복잡한 패턴을 학습

- **출력층:**  
  - 선형(linear) 활성화 함수  
  - 입력 패치의 중심 픽셀에 대한 연속적인 스칼라(실수) 값 출력  
  - 이 값은 해당 픽셀이 병변(또는 특정 구조)일 확률을 의미

#### 3.2 작동 방식

- 이미지를 작은 패치로 잘라서 각각의 패치를 MTANN에 입력
- 각 패치의 중심 픽셀에 대한 "가능성(probability) 맵" 생성
- 전체 이미지를 스캔하듯이 반복 적용하여, 모든 픽셀에 대해 가능성 맵 생성

#### 3.3 학습 및 출력 해석

- 학습 시, 병변(또는 관심 구조)이 중심에 있을 때 출력값이 최대(1)에 가깝게 되도록 학습
- 중심에서 멀어질수록 출력값이 감소, 병변 외부는 0에 가까운 값 출력
- 점수화 계층(score layer)을 추가하면, 전체 이미지를 하나의 점수(예: 병변 여부)로도 분류 가능

---

### 4. MTANN의 의료 영상 응용 사례

- **병변 검출 및 분류:**  
  - 예: 폐결절 검출, 양성/악성 분류 등
- **분할(Segmentation):**  
  - 예: 심장 좌심실 경계 강조, 장기 경계 추출
- **뼈와 연조직 분리:**  
  - 예: 폐 X-ray에서 늑골 억제(뼈 구조 제거)

---

### 5. MTANN과 CNN의 차이점

| 구분      | MTANN                                         | CNN                                         |
|-----------|-----------------------------------------------|---------------------------------------------|
| 컨볼루션 위치 | 외부(전체 이미지에 패치별로 적용)                | 내부(네트워크 내부에서 자동으로 컨볼루션)      |
| 출력 형태   | 이미지(가능성 맵, 연속값)                      | 클래스(분류 결과, 확률값)                    |
| 학습 데이터 | 적은 양으로도 학습 가능, 학습 속도 빠름           | 많은 데이터 필요, 학습 시간 오래 걸림          |
| 용도       | 미세 구조 탐지, 분할, 가능성 맵 생성 등           | 분류, 검출 등                                |

---

### 6. 결론

MTANN은 의료 영상에서 미세한 구조나 병변을 효과적으로 탐지하고 분할할 수 있는 강력한 도구입니다.  
적은 데이터로도 빠르게 학습할 수 있고, 가능성 맵을 통해 전문가가 직관적으로 결과를 해석할 수 있다는 장점이 있습니다.  
CNN과 비교해 구조와 출력 방식에서 차별점이 있으며, 의료 영상 분야에 특화된 딥러닝 모델로 널리 활용되고 있습니다.

---

**참고:**  
- 본 설명은 Meritis 블로그(https://meritis.fr/blog/deep-learning-in-medical-imaging-introducing-mtann) 내용을 바탕으로 작성되었습니다.  
- 추가적인 질문이 있으면 언제든 문의해 주세요!

