# Diffusion Models in Medical Imaging: A Comprehensive Survey 

## 1. 핵심 주장 및 주요 기여
**핵심 주장**  
본 논문은 의료 영상 분야에서 **확산 모형(diffusion models)**의 최근 발전과 응용을 체계적으로 정리하며, 해당 기법이 갖는 강력한 생성 성능과 모달리티 간 변환·재구성·노이즈 제거 등 다양한 의료 영상 과제에 대한 잠재력을 강조한다.

**주요 기여**  
- 의료 영상 분야에 특화된 최초의 확산 모형 서베이 제공  
- **알고리즘 관점**(DDPM, score-based, SDE)과 **응용 관점**(이미지 재구성, 분할, 변환, 이상 탐지 등) 양면에서 논문 분류 체계 구축  
- 각 연구를 영상 모달리티, 장기(organ), 사용된 확산 역정확기(reverse process) 알고리즘별로 다각적 분류  
- 실제 의료 응용 사례 비교·분석 및 오픈소스 구현 정리  
- 한계 분석 및 향후 연구 방향 제시

***

## 2. 문제 정의와 제안 방법

### 2.1 해결하고자 하는 문제  
의료 영상은 다중 모달리티 획득 비용, 데이터 불균형, 환자 프라이버시 제약 등으로 인해
- 부족한 데이터  
- 노이즈·아티팩트  
- 모달리티 간 불일치  
등 여러 과제를 안고 있으며, GAN/VAE 기반 생성 모델은 모드 붕괴, 품질 저하, 학습 불안정성 등의 한계를 가짐.  

### 2.2 제안 방법론 개요  
#### 2.2.1 확산 모형 기본 개념  
- **순방향 확산(Finite Forward Process)**: 원본 데이터 $$x_0$$에 점진적으로 가우시안 노이즈 $$\beta_t$$를 더해 $$x_T\sim\mathcal{N}(0,I)$$가 되도록 함.  

$$
    q(x_t\mid x_{t-1}) = \mathcal{N}\bigl(x_t; \sqrt{1-\beta_t}\,x_{t-1},\;\beta_t I\bigr)
  $$

- **역확산 역정확기(Reverse Process)**: $$\epsilon_\theta(x_t,t)$$ 신경망을 학습하여 노이즈를 제거하며 원본 분포로 복원  

$$
    p_\theta(x_{t-1}\mid x_t) = \mathcal{N}\bigl(x_{t-1};\mu_\theta(x_t,t),\;\Sigma_\theta(x_t,t)\bigr)
  $$

- **단순화된 손실** (Ho et al. 2020)  

$$
    L_{\mathrm{simple}} = \mathbb{E}\_{t,x_0,\epsilon}\bigl[\bigl\|\epsilon - \epsilon_\theta(x_t,t)\bigr\|^2\bigr]
  $$

#### 2.2.2 모델 구조  
- **공통 구조**: U-Net 기반 Denoising 네트워크 + 시간 스텝 임베딩  
- **조건부 확산**: 입력 MRI → CT 변환, K-space 제약, 메타데이터(성별·나이) 조건 등 다양한 입력 조건 추가  
- **Score-based & SDE**: 점근적 분산 모형, Langevin Dynamics 및 여러 수치적 해법(EM, PC, ODE) 적용  

### 2.3 성능 향상 기법  
- **Implicit & Classifier Guidance**: DDIM, DDPM 샘플링 가속 및 분류기 기반 방향성 제어  
- **Coarse-to-Fine Sampling**: 초기 샘플링 단계 축소, 중·고주파 영역 별 분리 복원  
- **Low-Frequency Regularization**: 구조 손실 억제, 세부 정보 보존  
- **Patch-based 처리**: 3D 볼륨의 메모리 효율 개선  

### 2.4 한계  
- **느린 샘플링 속도**: 수백~수천 단계 필요 → 실시간 응용 미흡  
- **높은 연산 비용**: GPU 메모리·연산량 과다  
- **잠재공간 표현력 부족**: 의미론적 latent 공간 학습 미흡  
- **프라이버시 위험**: 학습 데이터 과도 암기 가능성  

***

## 3. 모델 일반화 성능 향상 관점
- **강건한 조건부 확산**: 다양한 노이즈·모달리티 간 변환 조건을 통합해 시험 분포 밖 데이터도 복원 가능  
- **Self-Supervised Score Matching**: 라벨 없는 영역에도 자기지도 학습 적용 → 도메인 차이 감소  
- **Manifold Constraints**: 데이터 기저 공간 보존 제약으로 비지도 환경에서 이상치 내성 강화  
- **Federated Setting 활용 제안**: 분산 의료 데이터 학습 통해 분산도메인 일반화  

***

## 4. 향후 연구 영향 및 고려사항
- **다중 모달리티 확대**: 초음파·내시경 등 다양한 영상에 확산 모형 실험 필요  
- **잠재표현 개선**: 의미론적 특징 보존을 위한 조건부 인코더 결합  
- **효율적 샘플링**: 강화학습·스킵 연결 기반 역확산 길 찾기  
- **프라이버시 보호**: 디퍼렌셜 프라이버시·사이버 보안 메커니즘 통합  
- **연속적 학습(Federated & Continual)**: 의료기관 간 협력 학습으로 일반화·신뢰성 확보  

위 고려사항을 반영한 연구는 의료 영상 진단·재구성·합성 분야에서 확산 모형의 **임상 적용 가능성**을 획기적으로 개선할 것으로 기대된다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/b22fd30f-fcd8-4141-a92b-a4e7ee90baf2/1-s2.0-S1361841523001068-main.pdf

# 4. Diffusion Models in Action - 의료 영상에서의 확산 모형 응용

의료 영상 분야에서 확산 모형의 다양한 응용 사례들을 **9개의 주요 범주**로 분류하여 체계적으로 설명하겠습니다.

## 4.1 Image-to-Image Translation (이미지 간 변환)

### 핵심 목적
- 서로 다른 의료 영상 모달리티 간 변환 (예: MRI → CT)
- 누락된 모달리티 생성
- 진단과 치료에 필요한 다중 모달리티 영상 확보

### 주요 연구 사례

**1. MRI-CT 변환 (Lyu & Wang, 2022)**
- **문제점**: CT는 연조직 세부사항 표현 한계, MRI는 추가 촬영 시간과 비용 소요
- **해결방법**: 조건부 DDPM과 SDE를 활용하여 T2w MRI → CT 변환
- **성과**: SSIM, PSNR 지표에서 GAN/CNN 기반 방법들보다 우수한 성능
- **특징**: Monte Carlo 방법으로 불확실성 정량화

**2. 다중 모달리티 합성 (Meng et al., 2022)**
- **UMM-CSGM**: 통합 다중 모달 조건부 점수 기반 생성 접근법
- **특징**: 하나의 점수 기반 네트워크로 다양한 교차 모달 조건부 분포 학습
- **성과**: BraTS19 데이터셋에서 기존 SOTA 방법들 대비 고해상도·구조적 정보 보존

**3. 구조 보존 변환 (Li et al., 2023)**
- **FGDM**: 주파수 영역 필터를 활용한 구조 보존 이미지 변환
- **장점**: 제로샷 학습, 타겟 도메인 데이터만으로 훈련 가능
- **해결된 문제**: 확산 과정에서 해부학적 구조 정보 손실 방지

***

## 4.2 Reconstruction (재구성)

### 핵심 목적
- 저선량/언더샘플링된 의료 영상으로부터 고품질 영상 복원
- 환자 방사선 노출량 감소 및 스캔 시간 단축
- 역문제 해결을 통한 고해상도 의료 영상 획득

### 주요 연구 사례

**1. MRI 재구성 (Jalal et al., 2021)**
- **CSGM**: 압축 센싱과 생성 모델 결합
- **방법**: 점수 기반 생성 모델을 사전 정보로 활용, Langevin 역학으로 후방 샘플링
- **장점**: 분포 변화에 강건, 지도 학습 방법 대비 우수한 성능

**2. Score-MRI (Chung & Ye, 2022)**
- **프로세스**: 
  1. 크기 영상만으로 연속 시간 의존 점수 함수 훈련
  2. VE-SDE를 통한 측정값 조건부 샘플링
  3. 실수/허수 분리 후 예측기-데이터 일관성-보정기 순차 적용
- **특징**: 훈련 분포 외 해부학적 구조도 고해상도로 재구성 가능
- **다중 코일 처리**: 병렬 재구성 또는 코일 간 상관관계 고려 방식

**3. 제한각 CT 재구성 (Liu et al., 2022a)**
- **DOLCE**: 모델 기반 DDPM 패러다임
- **방법**: FBP 출력을 사전 정보로 활용, 일관성 항 추가
- **성과**: 날카로운 CT 영상 생성, SSIM/PSNR 우수

***

## 4.3 Registration (정합)

### 핵심 목적
- 움직이는 영상과 고정 영상 간의 비강체 관계 식별
- 연속적인 변형장 생성으로 현실적인 변형 모델링

### 주요 연구 사례

**DiffuseMorph (Kim et al., 2022)**
- **구조**: 확산 네트워크 + 변형 네트워크의 end-to-end 학습
- **과정**:
  1. 확산 네트워크: 움직이는 영상과 고정 영상 간 변형 점수화
  2. 변형 네트워크: 공간 정보 활용하여 연속 궤적 변형장 생성
  3. STL(Spatial Transformation Layer)로 최종 변형 영상 생성
- **장점**: 2D 얼굴 표정, 3D 의료 영상 모두에서 고정확도 달성

***

## 4.4 Classification (분류)

### 핵심 목적
- 의료 영상 내 다양한 구조와 이상소견 식별 및 특성화
- 대량의 복잡한 데이터 해석을 통한 의료진 보조

### 주요 연구 사례

**DiffMIC (Yang et al., 2023)**
- **DCG 모델**: 이중 입도 조건부 가이던스로 전역/지역 사전 정보 캡처
- **프로세스**:
  1. 입력 영상을 특징 임베딩 공간으로 인코딩
  2. 실측값과 두 사전 정보를 확산하여 노이즈 변수 생성
  3. U-Net이 각 임베딩의 노이즈 분포 예측
  4. MMD 정규화 손실과 MSE 손실로 훈련
- **응용 분야**: 태반 성숙도, 피부 병변, 당뇨 망막병증 분류

***

## 4.5 Segmentation (분할)

### 핵심 목적
- 해부학적 영역별 의미 있는 분할을 통한 의료 분석 지원
- 픽셀 단위 주석 데이터 부족 문제 해결

### 주요 연구 사례

**1. brainSPADE (Fernandez et al., 2022)**
- **구조**: 라벨 생성기 + 영상 생성기
- **과정**:
  1. 공간 VAE 인코더로 분할 맵 인코딩
  2. LDM을 통한 잠재 공간 확산 및 디노이징
  3. SPADE 모델로 합성 영상 생성
- **성과**: 합성 데이터만으로 실제 데이터와 유사한 성능, 결합 시 성능 개선

**2. DARL (Kim et al., 2023)**
- **자기지도 혈관 분할**: 확산 모듈 + 생성 모듈
- **이중 경로**:
  - 경로 A: 실제 노이즈 혈관조영술 → 분할 마스크
  - 경로 B: 노이즈 배경 + 혈관양 프랙털 → 합성 혈관조영술
- **순환 학습**: 생성된 합성 영상을 경로 A에 재입력하여 혈관 정보 학습

**3. CIMD (Rahman et al., 2023)**
- **모호한 분할**: 확률적 샘플링으로 다양하고 다중적인 마스크 생성
- **특징**: 노이즈 분할 실측 마스크를 원본 영상과 연결하여 훈련
- **평가**: Collective Insight Score로 불확실성 정량화

***

## 4.6 Denoising (노이즈 제거)

### 핵심 목적
- 획득/처리 과정에서 발생하는 노이즈와 아티팩트 제거
- 영상 품질 개선을 통한 진단 정확도 향상

### 주요 연구 사례

**1. OCT 스페클 노이즈 제거 (Hu et al., 2022)**
- **DenoOCT-DDPM**: 자기융합 전처리 + DDPM
- **특징**: 노이즈 패턴 학습에 특화, 실제 데이터 패턴이 아닌 노이즈 분포 모델링
- **성과**: 세밀한 혈관 구조 보존하면서 스페클 노이즈 효과적 제거

**2. PET 영상 노이즈 제거 (Gong et al., 2022)**
- **PET-DDPM**: 보조 모달리티(MR) 임베딩을 사전 정보로 활용
- **다중 모달리티**: 18F-FDG, 18F-MK-6240 데이터셋
- **분류기 가이던스**: 원하는 분포로 수렴하도록 가이드
- **성과**: U-Net 기반 노이즈 제거 네트워크 대비 PSNR/SSIM 우수

**3. 확산 MRI 노이즈 제거 (Xiang et al., 2023)**
- **3단계 접근법**:
  1. 자기지도 방식으로 초기 노이즈 분포 학습
  2. μ=0, σ 가우시안 분포로 노이즈 모델 추정
  3. 비지도 방식으로 깨끗한 영상 생성하는 확산 모델 훈련

***

## 4.7 Image Generation (영상 생성)

### 핵심 목적
- 합성 2D/3D 의료 영상 생성
- 교육, 연구, 데이터 증강 목적의 현실적인 의료 영상 제공

### 주요 연구 사례

**1. 4D 시간적 영상 생성 (Kim & Ye, 2022)**
- **DDM**: DDPM 모듈 + 변형 모듈
- **프로세스**:
  1. 소스/타겟 영상으로 잠재 코드 구성
  2. 잠재 코드와 소스 영상으로 변형장 생성
  3. STL로 중간 시간 프레임들 생성
- **응용**: 심장 영상의 연속적인 시간 변화 모델링

**2. 흉부 X선 생성 (Packhäuser et al., 2022)**
- **잠재 확산 모델**: 클래스 조건부 고품질 흉부 X선 영상
- **프라이버시**: 민감한 생체 정보 보호하는 샘플링 전략
- **성과**: GAN 기반 방법들 대비 우수한 성능

**3. 조직병리학 영상 생성 (Moghadam et al., 2023)**
- **MFDPM**: 유전자형 가이던스로 형태학적·유전학적 정보 포함
- **전처리**: 색상 정규화 + 형태학 레벨 우선순위 모듈
- **성과**: 병리학자도 실제와 구분하기 어려운 고품질 합성 영상

**4. 다중 모달리티 MRI 합성 (Jiang et al., 2023)**
- **CoLa-Diff**: 잠재 공간 기반 메모리 효율적 처리
- **협업 필터링**: 잠재 공간 압축/노이즈 문제 해결
- **구조 보존**: 뇌 영역 마스크를 밀도 분포 사전 정보로 활용

***

## 4.8 Anomaly Detection (이상 탐지)

### 핵심 목적
- 의료 영상에서 비정상적인 영역 강조 및 위치 식별
- 건강한 상태와 질병 상태 구분을 통한 진단 보조

### 주요 연구 사례

**1. 약지도 학습 이상 탐지 (Wolleb et al., 2022a)**
- **DDIM 기반**: 입력 영상 → 건강한 영상으로 변환
- **프로세스**:
  1. 역 DDIM 샘플링으로 노이즈 영상으로 인코딩
  2. 사전 훈련된 이진 분류기로 디노이징 과정 가이드
  3. 출력과 입력 차이로 이상 맵 계산
- **성과**: VAE, GAN 모델들 대비 우수한 성능

**2. CDPM (Sanchez et al., 2022)**
- **반사실적 생성**: 사실적 입력 → 건강한 반사실적 영상
- **암시적 가이던스**: 건강 상태 조건부 디코딩
- **조건부 어텐션**: U-Net 백본에 통합
- **동적 정규화**: 잠재 공간 픽셀 포화 방지

**3. BAnoDDPM (Pinaya et al., 2022a)**
- **VQ-VAE + DDPM**: 압축된 잠재 표현에서 건강 샘플 분포 학습
- **이진 마스크**: 역방향 과정 중간 샘플들의 평균으로 이상 위치 구성
- **선택적 디노이징**: 마스크 활용하여 이상 영역만 복원

**4. 패치 기반 방법 (Behrendt et al., 2023)**
- **pDDPMs**: 전체 영상 동시 노이즈 추가의 문제점 해결
- **공간적 맥락**: 부분적으로 노이즈가 추가된 전체 영상으로 패치 복원
- **슬라이딩 윈도우**: 순차적 패치 처리 후 최종 결합

***

## 4.9 Other Applications (기타 응용)

### 다중 작업 학습 및 특수 응용

**1. 다중 연속 패러다임 (Chung et al., 2022a)**
- **R2D2+**: MRI 노이즈 제거 + 초해상도
- **비모수 추정**: 공분산 행렬 고유값 분석 기반
- **저주파 정규화**: 구조적 정보 보존
- **가속화**: 순수 노이즈가 아닌 초기 노이즈 영상에서 시작

**2. 적대적 공격 방어 (Wang et al., 2022)**
- **다중 스케일**: 이미지 피라미드와 가우시안 노이즈 주입
- **디노이징 메커니즘**: 추가된 노이즈 제거 및 이웃 스케일 정보 집계
- **스케일 융합**: 다양한 스케일의 하위 영상들을 결합

**3. 계층적 다중 라벨 탐지 (Hamamci et al., 2023)**
- **DiffusionDet**: 노이즈 박스로부터 객체와 범주 예측
- **3단계 접근**:
  1. 사분면과 경계 박스 좌표 예측
  2. 치아 번호, 사분면 번호, 경계 박스 예측
  3. 비정상 치아와 진단 라벨 탐지

***

## 4.10 비교 개요

### 알고리즘별 분류
- **DDPMs (35개 연구)**: 가장 널리 사용, 다양한 응용 분야
- **NCSNs (2개 연구)**: Langevin 역학 기반, MRI 재구성 특화
- **SDEs (11개 연구)**: 연속적 접근법, 다중 모달리티 변환에 우수

### 주요 기술 트렌드
1. **조건부 확산**: 영상, 메타데이터, 분류기 가이던스 활용
2. **가속화 기법**: DDIM, 좋은 초기화, 적대적 학습
3. **품질 개선**: 다양한 노이즈 분포, 고주파 영역 처리
4. **효율성**: 패치 기반 처리, 잠재 확산 모델

### 응용 분야별 인기도
- **재구성, 노이즈 제거, 생성**: 확산 모델 이론과 높은 호환성
- **분할, 분류**: 상대적으로 적은 연구, 추가 네트워크 구조 필요
- **전망**: 시간이 지나면서 더 다양한 작업으로 확장 예상

이러한 체계적 분류를 통해 확산 모형이 의료 영상 분야에서 얼마나 다양하고 효과적으로 활용되고 있는지 확인할 수 있으며, 각 응용 분야의 특성과 해결하는 문제들을 명확히 이해할 수 있습니다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/b22fd30f-fcd8-4141-a92b-a4e7ee90baf2/1-s2.0-S1361841523001068-main.pdf
